{
  "version": 3,
  "sources": ["../../../src/router/router.ts"],
  "sourcesContent": ["import type { Router, Execute } from \"./types\";\n//import { eventDrive } from \"../render\";\n\nexport const router: Router = ({ routes, context }) => {\n  const _routes = routes;\n  let _routerElement!: HTMLElement;\n\n  const execute: Execute = (validator, callback, error) => {\n    if (validator()) return callback({ isValid: validator() });\n\n    if (error) {\n      const erro = new Error(error().message);\n      erro.name = error().name;\n      throw erro;\n    }\n  };\n\n  const cleanupStyles = async (selector: string) => {\n    if (!selector) return;\n\n    const styleElement = document.head.querySelector(\n      `[data-component=${selector}]`,\n    );\n    if (styleElement) {\n      styleElement.remove();\n    }\n  };\n\n  const cleanupDOM = async () => {\n    _routerElement.replaceChildren();\n  };\n\n  const getChildSelector = (): string => {\n    const child = _routerElement.firstElementChild;\n    const selector = child ? Object.values(child.classList).shift() : \"\";\n    return selector as string;\n  };\n\n  const cleanupCurrentRoute = async () => {\n    try {\n      const selector = getChildSelector();\n      await cleanupStyles(selector);\n      await cleanupDOM();\n      return Promise.resolve();\n    } catch (error) {\n      return Promise.reject(error);\n    }\n  };\n\n  const _bindListeners = () => {\n    window.addEventListener(\"hashchange\", async () => {\n      try {\n        await cleanupCurrentRoute();\n        await _mountRouteByHash(null);\n      } catch (error) {\n        console.error(\"Error during route change:\", error);\n        // Aqui voc\u00EA pode adicionar l\u00F3gica de fallback ou recupera\u00E7\u00E3o de erro\n      }\n    });\n  };\n\n  const _setRouterElement = () => {\n    const routerElement = context?.querySelector(\"router-view\");\n\n    execute(\n      () => !!routerElement,\n      () => {\n        _routerElement = routerElement as HTMLElement;\n        return _routerElement;\n      },\n      () => ({\n        name: \"Router Error\",\n        message: \"Router element (router-view) is not defined and must be.\",\n      }),\n    );\n  };\n\n  const _loadMainRoute = () => {\n    const mainRoute = _getMainRoute();\n    execute(\n      () => !!mainRoute?.start,\n      () => mainRoute?.start && navigate(mainRoute.start),\n      () => ({\n        name: \"Router Error\",\n        message: \"Start router is not defined and must be.\",\n      }),\n    );\n  };\n\n  const _getMainRoute = () => _routes.find((route) => !!route?.start);\n\n  const _getRouteByHash = (hash: string) => {\n    return _routes.find((route) => route.regex.test(hash));\n  };\n\n  const _getRouteDefault = () => _routes.find((route) => route?.default);\n\n  const _mountRouteByHash = async (hash: string | null) => {\n    const hashValue = hash || window.location.hash || \"\";\n    const route = _getRouteByHash(hashValue) || _getRouteDefault();\n    _routerElement.innerHTML = \"\";\n    route?.mount({ context: _routerElement });\n  };\n\n  const _getHash = () => window.location.hash || null;\n\n  const _hasActiveRoute = () => !!_getHash();\n\n  const navigate = (path: string) => {\n    window.location.hash = path;\n  };\n\n  const init = () => {\n    _bindListeners();\n    _setRouterElement();\n    _hasActiveRoute() ? _mountRouteByHash(_getHash()) : _loadMainRoute();\n  };\n\n  return { init, navigate };\n};\n"],
  "mappings": "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",
  "names": []
}
