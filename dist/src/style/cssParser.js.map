{
  "version": 3,
  "sources": ["../../../src/style/cssParser.ts"],
  "sourcesContent": ["interface WrapStyleParams {\n  style: string;\n  selector: string;\n}\n\nconst wrapLooseRulesOutsideMediaQuery = ({\n  style,\n  selector,\n}: WrapStyleParams): string => {\n  const lines = style.split(\"\\n\");\n  const ruleRegex = /^\\s*([\\w-]+)\\s*:\\s*[^;]+;/;\n\n  interface Accumulator {\n    insideBlock: number;\n    globalRules: string;\n    result: string;\n  }\n\n  interface LineProcessing {\n    globalRules: string;\n    result: string;\n  }\n\n  const initialState: Accumulator = {\n    insideBlock: 0,\n    globalRules: \"\",\n    result: \"\",\n  };\n\n  const processGlobalRules = (\n    globalRules: string,\n    result: string,\n    selector: string,\n  ): LineProcessing => ({\n    globalRules: \"\",\n    result: `${result}${selector} {\\n${globalRules}}\\n\\n`,\n  });\n\n  const processRegularLine = (\n    line: string,\n    result: string,\n  ): LineProcessing => ({\n    globalRules: \"\",\n    result: `${result}${line}\\n`,\n  });\n\n  const addGlobalRule = (\n    line: string,\n    globalRules: string,\n  ): LineProcessing => ({\n    globalRules: `${globalRules}${line}\\n`,\n    result: \"\",\n  });\n\n  const countBlocks = (line: string): number => {\n    const openings = (line.match(/{/g) || []).length;\n    const closings = (line.match(/}/g) || []).length;\n    return openings - closings;\n  };\n\n  const processLine = (acc: Accumulator, line: string): Accumulator => {\n    acc.insideBlock += countBlocks(line);\n\n    // Case 1: Line is a global rule\n    if (acc.insideBlock === 0 && ruleRegex.test(line)) {\n      const { globalRules, result } = addGlobalRule(line, acc.globalRules);\n      return { ...acc, globalRules, result: acc.result + result };\n    }\n\n    // Case 2: There are accumulated global rules\n    if (acc.globalRules) {\n      const { globalRules, result } = processGlobalRules(\n        acc.globalRules,\n        acc.result,\n        selector,\n      );\n      const processedLine = processRegularLine(line, \"\");\n      return {\n        ...acc,\n        globalRules,\n        result: result + processedLine.result,\n      };\n    }\n\n    // Case 3: Regular line\n    const { globalRules, result } = processRegularLine(line, acc.result);\n    return { ...acc, globalRules, result };\n  };\n\n  const { result, globalRules } = lines.reduce(processLine, initialState);\n\n  return globalRules\n    ? `${result}${selector} {\\n${globalRules}}\\n`.trim()\n    : result.trim();\n};\n\nconst wrapLooseRulesInsideMediaQuery = ({\n  style,\n  selector,\n}: WrapStyleParams): string => {\n  const regex = /@media\\s*([^{]+)\\s*\\{([\\s\\S]*?)\\}/g;\n\n  return style.replace(regex, (match, mediaQuery, innerCss) => {\n    const rules = innerCss\n      .trim()\n      .split(\"\\n\")\n      .map((line: string) => line.trim())\n      .filter((line: string) => line);\n\n    const wrappedRules = rules\n      .map((rule: string) => `    ${selector} {\\n        ${rule.trim()}\\n    }`)\n      .join(\"\\n\");\n\n    return `@media ${mediaQuery.trim()} {\\n${wrappedRules}\\n}`;\n  });\n};\n\nconst applyClassNameScope = ({ style, selector }: WrapStyleParams): string => {\n  const regex = /\\.(\\w+)/g;\n  return style.replace(regex, `.${selector}_$1`);\n};\n\nexport const transformStyle = (rawStyle: string, selector: string): string => {\n  let style = rawStyle;\n  const className = `.${selector}`;\n  style = applyClassNameScope({ style, selector });\n  style = wrapLooseRulesOutsideMediaQuery({ style, selector: className });\n  style = wrapLooseRulesInsideMediaQuery({ style, selector: className });\n\n  return style;\n};\n"],
  "mappings": "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",
  "names": ["wrapLooseRulesOutsideMediaQuery", "__name", "style", "selector", "lines", "ruleRegex", "initialState", "processGlobalRules", "globalRules", "result", "processRegularLine", "line", "addGlobalRule", "countBlocks", "openings", "closings", "processLine", "acc", "processedLine", "wrapLooseRulesInsideMediaQuery", "regex", "match", "mediaQuery", "innerCss", "wrappedRules", "rule", "applyClassNameScope", "transformStyle", "rawStyle", "className"]
}
